!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/hmppsAssets",t(t.s=0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}n(1),n(2),n(3),n(4),n(5),n(6);var r=n(7),i=o(r),s=n(8),a=o(s),c=n(9),u=o(c),d=n(10),l=o(d),m=n(11),f=o(m),p=window.HMPPS||{ereader:a.default,chess:u.default,sudoku:l.default,neontroids:f.default};p.addCookieMessage=function(){var e=document.getElementById("global-cookie-message");e&&null===(0,i.default)("seen_cookie_message")&&(e.style.display="block",(0,i.default)("seen_cookie_message","yes",{days:28}))},document.addEventListener("DOMContentLoaded",function(){p.addCookieMessage(),Object.keys(p).forEach(function(e){"function"==typeof p[e].init&&p[e].init()})}),window.HMPPS=p},function(e,t,n){"use strict";!function(){function e(e,t,n){e.addEventListener?e.addEventListener(t,function(e){n(e,e.target)},!1):e.attachEvent&&e.attachEvent("on"+t,function(e){n(e,e.srcElement)})}function t(e){return"number"==typeof e.which?e.which:e.keyCode}function n(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function o(o,r){e(o,"keypress",function(e,o){t(e)!==a&&t(e)!==c||"summary"===o.nodeName.toLowerCase()&&(n(e),o.click?o.click():r(e,o))}),e(o,"keyup",function(e,o){t(e)===c&&"SUMMARY"===o.nodeName&&n(e)}),e(o,"click",function(e,t){r(e,t)})}function r(e,t){do{if(!e||e.nodeName.toLowerCase()===t)break;e=e.parentNode}while(e);return e}function i(e){function t(e){var t="true"===e.__details.__summary.getAttribute("aria-expanded"),n="true"===e.__details.__content.getAttribute("aria-hidden");if(e.__details.__summary.setAttribute("aria-expanded",t?"false":"true"),e.__details.__content.setAttribute("aria-hidden",n?"false":"true"),!s){e.__details.__content.style.display=t?"none":"";null!==e.__details.getAttribute("open")?e.__details.removeAttribute("open"):e.__details.setAttribute("open","open")}return e.__twisty&&(e.__twisty.firstChild.nodeValue=t?"►":"▼",e.__twisty.setAttribute("class",t?"arrow arrow-closed":"arrow arrow-open")),!0}if(!u&&(u=!0,0!==(e=document.getElementsByTagName("details")).length)){var n=e.length,i=0;for(i;i<n;i++){var a=e[i];if(a.__summary=a.getElementsByTagName("summary").item(0),a.__content=a.getElementsByTagName("div").item(0),!a.__summary||!a.__content)return;a.__content.id||(a.__content.id="details-content-"+i),a.setAttribute("role","group"),a.__summary.setAttribute("role","button"),a.__summary.setAttribute("aria-controls",a.__content.id),s||(a.__summary.tabIndex=0);var c=null!==a.getAttribute("open");if(!0===c?(a.__summary.setAttribute("aria-expanded","true"),a.__content.setAttribute("aria-hidden","false")):(a.__summary.setAttribute("aria-expanded","false"),a.__content.setAttribute("aria-hidden","true"),s||(a.__content.style.display="none")),a.__summary.__details=a,!s){var d=document.createElement("i");!0===c?(d.className="arrow arrow-open",d.appendChild(document.createTextNode("▼"))):(d.className="arrow arrow-closed",d.appendChild(document.createTextNode("►"))),a.__summary.__twisty=a.__summary.insertBefore(d,a.__summary.firstChild),a.__summary.__twisty.setAttribute("aria-hidden","true")}}o(document,function(e,n){return!(n=r(n,"summary"))||t(n)})}}var s="boolean"==typeof document.createElement("details").open,a=13,c=32,u=!1;e(document,"DOMContentLoaded",i),e(window,"load",i)}()},function(e,t,n){"use strict";Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,o=function(){},r=function(){return n.apply(this instanceof o&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return o.prototype=this.prototype,r.prototype=new o,r})},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=e+"="+t+"; path=/";if(n.days){var r=new Date;r.setTime(24*(r.getTime()+n.days)*60*60*1e3),o+="; expires="+r.toGMTString()}"https:"===document.location.protocol&&(o+="; Secure"),document.cookie=o},r=function(e){for(var t=e+"=",n=document.cookie.split(";"),o=0,r=n.length;o<r;o++){for(var i=n[o];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length))}return null},i=function(e,t,n){return void 0!==t?!1===t||null===t?o(e,"",{days:-1}):o(e,t,n):r(e)};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{init:function(){var e=document.querySelectorAll(".js-ereader-trigger");if(!e)return!1;Array.prototype.forEach.call(e,function(e,t){e.addEventListener("click",function(e){HMPPS.ereader.openBook(e),console.log(e)})})},openBook:function(e){e.preventDefault();var t=e.currentTarget.getAttribute("href"),n=e.currentTarget.getAttribute("data-filetype"),o=["height="+(screen.height-100),"width="+screen.width,"fullscreen=yes","scrollbars=yes"].join(",");if("pdf"===n){window.open(t,"_blank",o)}else{var r=window.open(t,"_blank",o);HMPPS.ereader.createEpub(t,r)}},createEpub:function(e,t){HMPPS.ereader.createMarkup(t);var n=t.document.body;n.classList.add("epub"),console.log(e);var o=n.querySelector(".js-ereader-next"),r=n.querySelector(".js-ereader-prev"),i=n.querySelector(".js-ereader-area"),s=new EPUBJS.Book({width:t.innerWidth/2,height:t.innerHeight,orientation:"auto",spreads:"false",restore:"true",bookPath:e,method:"paginate"});console.log(s),s.renderTo(i).then(function(){s.open(e)}),r.addEventListener("click",function(){s.prevPage()}),o.addEventListener("click",function(){s.nextPage()});var a=function(e){37===(e.keyCode||e.which)&&s.prevPage(),39===(e.keyCode||e.which)&&s.nextPage()};s.on("keyup",a)},createMarkup:function(e){var t=document.createElement("div");t.innerHTML='<div class="ereader__area js-ereader-area"></div>\n      <div class="ereader__buttons">\n        <button class="js-ereader-prev ereader__prev" type="button" name="button">Prev</button>\n        <button class="js-ereader-next ereader__next" type="button" name="button">Next</button>\n      </div>',t.classList.add("ereader"),e.document.write('<html><head><title>Book</title><link href="/hmppsAssets/css/hmpps.css"  rel="stylesheet" type="text/css"></head><body></body></html>'),e.document.body.appendChild(t)}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(){return{init:function(){var e=this,t=document.querySelector(".js-chess");document.querySelector(".js-newgame");if(!t)return!1;var n=HMPPS.chess.engineGame(),o=function(){var e=parseInt($("#skillLevel").val());n.reset(),n.setSkillLevel(e),n.setPlayerColor(($("#color-white").hasClass("active"),"white")),n.setDisplayScore($("#showScore").is(":checked")),n.start()};n.setSkillLevel,document.querySelector("#skillLevel").addEventListener("change",function(t){n.setSkillLevel(parseInt(e.value,10))}),document.querySelector(".js-newgame").addEventListener("click",function(e){o()}),o()},engineGame:function(e){function t(e,t){(t||m).postMessage(e)}function n(e,t){var n=!1;v.startTime>0&&e==v.clockColor&&(t=Math.max(0,t+v.startTime-Date.now()),n=!0);var o=e==y?"#time2":"#time1",r=Math.ceil(t/1e3),i=Math.floor(r/60);r-=60*i;var s=Math.floor(i/60);i-=60*s;var a=s+":"+("0"+i).slice(-2)+":"+("0"+r).slice(-2);n&&(a+=1&r?" <--":" <-"),$(o).text(a)}function r(){n("white",v.wtime),n("black",v.btime)}function i(){r();var e=("white"==v.clockColor?v.wtime:v.btime)+v.startTime-Date.now(),t=e%1e3+1;b=setTimeout(i,t)}function s(){if(null!==b&&(clearTimeout(b),b=null),v.startTime>0){var e=Date.now()-v.startTime;v.startTime=null,"white"==v.clockColor?v.wtime=Math.max(0,v.wtime-e):v.btime=Math.max(0,v.btime-e)}}function a(){"w"==d.turn()?(v.wtime+=v.winc,v.clockColor="white"):(v.btime+=v.binc,v.clockColor="black"),v.startTime=Date.now(),i()}function c(){var e="",t=d.history({verbose:!0}),n=!0,o=!1,r=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var a=i.value;e+=" "+a.from+a.to+(a.promotion?a.promotion:"")}}catch(e){o=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(o)throw r}}return e}function u(){s(),$(".js-chessmoves").text(d.pgn()),l.position(d.fen()),r();var e="w"==d.turn()?"white":"black";d.game_over()||(e!=y&&(t("position startpos moves"+c()),t("position startpos moves"+c(),f),g.textContent="",t("eval",f),t(v&&v.wtime?"go "+(v.depth?"depth "+v.depth:"")+" wtime "+v.wtime+" winc "+v.winc+" btime "+v.btime+" binc "+v.binc:"go "+(v.depth?"depth "+v.depth:"")),_=!0),d.history().length>=2&&!v.depth&&!v.nodes&&a())}var d=new Chess,l=void 0,m="function"==typeof STOCKFISH?STOCKFISH():new Worker(e.stockfishjs||"stockfish.js"),f="function"==typeof STOCKFISH?STOCKFISH():new Worker(e.stockfishjs||"stockfish.js"),p={},h=!1,v={wtime:3e5,btime:3e5,winc:2e3,binc:2e3},y="white",b=null,_=!1,g=document.getElementById("evaluation"),w=void 0,k=function(e,t,n,o){var r="white"==y?/^b/:/^w/;if(d.game_over()||-1!==t.search(r))return!1};setInterval(function(){w||d.game_over()&&(w=!0,alert("Game Over"))},1e3),t("uci"),f.onmessage=function(e){var t;"uciok"!==(t=e&&"object"===(void 0===e?"undefined":o(e))?e.data:e)&&"readyok"!==t&&"option name"!==t.substr(0,11)&&(g.textContent&&(g.textContent+="\n"),g.textContent+=t)},m.onmessage=function(e){var n=void 0;if("uciok"==(n=e&&"object"===(void 0===e?"undefined":o(e))?e.data:e))p.engineLoaded=!0;else if("readyok"==n)p.engineReady=!0;else{var r=n.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/);if(r?(_=!1,d.move({from:r[1],to:r[2],promotion:r[3]}),u(),t("eval",f),g.textContent=""):(r=n.match(/^info .*\bdepth (\d+) .*\bnps (\d+)/))&&(p.search="Depth: "+r[1]+" Nps: "+r[2]),r=n.match(/^info .*\bscore (\w+) (-?\d+)/)){var i=parseInt(r[2])*("w"==d.turn()?1:-1);"cp"==r[1]?p.score=(i/100).toFixed(2):"mate"==r[1]&&(p.score="Mate in "+Math.abs(i)),(r=n.match(/\b(upper|lower)bound\b/))&&(p.score=("upper"==r[1]==("w"==d.turn())?"<= ":">= ")+p.score)}}};var S=function(e,t){var n=document.querySelectorAll(".js-promote"),o=void 0;Array.prototype.forEach.call(n,function(e,t){if(!0===e.checked)return void(o=e)});var r=d.move({from:e,to:t,promotion:o});if(console.log(r),null===r)return"snapback";u()},j=function(){l.position(d.fen())},C={showErrors:!0,draggable:!0,position:"start",onDragStart:k,onDrop:S,onSnapEnd:j,pieceTheme:"/hmppsAssets/img/chesspieces/wikipedia/{piece}.png"};return l=new ChessBoard("js-board",C),{reset:function(){d.reset(),t("setoption name Contempt value 0"),this.setSkillLevel(0),t("setoption name King Safety value 0")},loadPgn:function(e){d.load_pgn(e)},setPlayerColor:function(e){y=e,l.orientation(y)},setSkillLevel:function(e){var n,o;e<0&&(e=0),e>20&&(e=20),v.level=e,v.depth=e<5?"1":e<10?"2":e<15?"3":"",t("setoption name Skill Level value "+e),o=Math.round(6.35*e+1),n=Math.round(-.5*e+10),t("setoption name Skill Level Maximum Error value "+n),t("setoption name Skill Level Probability value "+o)},setTime:function(e,t){v={wtime:1e3*e,btime:1e3*e,winc:1e3*t,binc:1e3*t}},setDepth:function(e){v={depth:e}},setNodes:function(e){v={nodes:e}},setContempt:function(e){t("setoption name Contempt value "+e)},setAggressiveness:function(e){t("setoption name Aggressiveness value "+e)},setDisplayScore:function(e){h=e},start:function(){t("ucinewgame"),t("isready"),p.engineReady=!1,p.search=null,u(),w=!1},undo:function(){return!_&&(d.undo(),d.undo(),p.search=null,u(),!0)}}}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{init:function(){var e=document.querySelector(".js-sudoku-alert"),t=document.querySelector(".js-sudoku-newgame");if(!e)return!1;var n=$(".js-sudoku").sudokuJS({difficulty:"Easy",boardFinishedFn:function(t){e.classList.add("show")}});t.addEventListener("click",function(t){e.classList.remove("show"),HMPPS.sudoku.clearErrors(),n.generateBoard("easy")})},clearErrors:function(){$(".js-sudoku input").filter(function(){$(this).removeAttr("disabled"),$(this).removeClass("board-cell--error highlight-val")})}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{init:function(){var e=document.querySelector(".js-neontroids"),t=document.querySelector(".js-neontroids-trigger");e&&t.addEventListener("click",function(t){t.preventDefault();var n=["/hmppsAssets/js/src/third-party/lib/sound-fx.js","/hmppsAssets/js/src/third-party/lib/keyboard-io.js","/hmppsAssets/js/src/third-party/lib/collisions.js","/hmppsAssets/js/src/third-party/lib/asteroids-sprites.js","/hmppsAssets/js/src/third-party/lib/asteroids-polygon.js","/hmppsAssets/js/src/third-party/lib/display-text.js","/hmppsAssets/js/src/third-party/lib/asteroids.js"],o=new HMPPS.neontroids.ScriptLoader;n.forEach(function(e){o.add(e)});var r=document.createElement("div");r.classList.add("modal");r.innerHTML="<canvas id='canvas' class='canvas'></canvas>\n          <button class='js-neontroids-close neontroids__close' type='button' name='button'>Close</button>",document.body.appendChild(r),e.classList.add("neontroids-active"),document.body.classList.add("modal-active"),document.getElementsByTagName("html")[0].classList.add("modal-active");var i=document.querySelector(".js-neontroids-close");i.focus(),i.addEventListener("click",function(){HMPPS.neontroids.destroy()})})},destroy:function(){var e=document.querySelector(".modal");document.body.removeChild(e)},ScriptLoader:function(){var e=[];this.add=function(t){var n=new Promise(function(e,n){var o=document.createElement("script");o.src=t,o.type="text/javascript",o.async=!0,o.addEventListener("load",function(){e(o)},!1),o.addEventListener("error",function(){n(o),console.log("was rej")},!1),document.body.appendChild(o)});e.push(n),console.log(e)},this.loaded=function(t){Promise.all(e).then(function(e){console.log("Script loaded from:",e)},t)}}}}()}]);